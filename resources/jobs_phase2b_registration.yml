# Phase 2b: Model Registration & Evaluation
# Registers trained model to Unity Catalog and evaluates performance
# Can run independently after Phase 2 training completes

resources:
  jobs:
    # Registration job - Register and evaluate model
    register_evaluate_model:
      name: "[${bundle.target}] Entity Matching - Phase 2b: Register & Evaluate Model"

      tasks:
        - task_key: register_and_evaluate
          notebook_task:
            notebook_path: ../notebooks/02b_register_evaluate_model.py
            base_parameters:
              workspace_path: ${workspace.root_path}/files
              catalog_name: ${var.catalog_name}
              output_path: ${workspace.root_path}/training_data
              bundle_target: ${bundle.target}
          timeout_seconds: 3600  # 1 hour for registration and evaluation

      max_concurrent_runs: 1
      email_notifications:
        on_success:
          - ${workspace.current_user.userName}@databricks.com
        on_failure:
          - ${workspace.current_user.userName}@databricks.com
      tags:
        project: entity_matching
        environment: ${bundle.target}
        phase: "2b"
        step: model_registration
